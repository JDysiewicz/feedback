(this.webpackJsonpfeedback=this.webpackJsonpfeedback||[]).push([[0],{132:function(e,t,n){},133:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(0),o=n(64),s=n.n(o),r=n(34),i=n(2),d=n(35),l=n.n(d),b=n(65),u=n(7),j=n(66),m=n.n(j),h=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),o=n[0],s=n[1],r=Object(c.useState)(),d=Object(u.a)(r,2),j=d[0],h=d[1];Object(c.useEffect)((function(){void 0!==e.location.state&&alert(e.location.state.message)}),[]);var O=function(){var e=Object(b.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==o){e.next=3;break}return alert("Room ID empty"),e.abrupt("return");case 3:return e.prev=3,e.next=6,m.a.get("/api/valid-room",{params:{boardId:o}});case 6:if(e.sent){e.next=9;break}return e.abrupt("return",console.log("No room by that name!"));case 9:h({search:"?board=".concat(o),roomCreator:!1}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),alert("ERROR: ".concat(e.t0.response.data.message)),s("");case 16:return e.abrupt("return");case 17:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(){return e.apply(this,arguments)}}();return void 0!==j?Object(a.jsx)(i.a,{to:{pathname:"/board",search:j.search,state:{roomCreator:j.roomCreator}}}):Object(a.jsxs)("div",{className:"SplashScreen-main-div",children:[Object(a.jsx)("h1",{children:"Anonymous Feedback"}),Object(a.jsx)("button",{onClick:function(){return function(){var e=(1e6*Math.random()).toString().split(".")[0],t={search:"?board=".concat(e),roomCreator:!0};h(t)}()},children:"Create a room"}),Object(a.jsx)("h3",{children:"OR"}),Object(a.jsxs)("div",{className:"SplashScreen-join-room",children:[Object(a.jsx)("label",{htmlFor:"room-id",children:"RoomID:"}),Object(a.jsx)("input",{id:"room-id",name:"room-id",value:o,onChange:function(e){return s(e.target.value)},placeholder:"Enter Room ID"}),Object(a.jsx)("button",{onClick:function(){return O()},children:"Join an existing room using Room ID"})]})]})},O=n(39),f=n(38),v=n(68),p=n.n(v),g=n(69),x=n.n(g),k=function(e){return Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:function(){return e.toggleHideVotes()},children:"Toggle Vote Visibility"})})},C=function(e){var t=e.message,n=e.personalVote,c=e.voteMessage,o=e.hideVotes;return Object(a.jsxs)("div",{className:"FeedbackMessage-main-div",children:[Object(a.jsxs)("p",{children:[t.message," "]}),Object(a.jsxs)("div",{className:"FeedbackMessage-voting-buttons",children:[Object(a.jsx)("button",{style:{backgroundColor:"green"},onClick:function(){return c(t,1)},children:"Upvote"}),Object(a.jsx)("button",{onClick:function(){return c(t,-1)},children:"Downvote"})]}),Object(a.jsxs)("div",{className:"FeedbackMessage-votes",children:[Object(a.jsxs)("p",{children:["Personal Vote: ",n," "]}),Object(a.jsxs)("p",{children:[" ",Object(a.jsxs)("strong",{children:["Total Votes: ",o?Object(a.jsx)("i",{style:{color:"grey"},children:"hidden by room owner"}):t.upvotes," "]})]})]})]})},y=function(e){if(""===e.location.search)return Object(a.jsx)("div",{children:"Please create or join a room"});var t=Object(c.useState)([]),n=Object(u.a)(t,2),o=n[0],s=n[1],r=Object(c.useState)(""),d=Object(u.a)(r,2),l=d[0],b=d[1],j=Object(c.useState)(""),m=Object(u.a)(j,2),h=m[0],v=m[1],g=Object(c.useState)(),y=Object(u.a)(g,2),I=y[0],S=y[1],V=Object(c.useState)(!1),w=Object(u.a)(V,2),N=w[0],E=w[1],M=Object(c.useState)(""),R=Object(u.a)(M,2),F=R[0],B=R[1],D=Object(c.useState)(),A=Object(u.a)(D,2),T=A[0],J=A[1],P=Object(c.useState)(!0),H=Object(u.a)(P,2),U=H[0],W=H[1],q=Object(c.useState)([]),z=Object(u.a)(q,2),L=z[0],G=z[1];if(Object(c.useEffect)((function(){if(""!==e.location.search){if(void 0!==e.location.state){var t=e.location.state.roomCreator;E(t)}var n=p.a.parse(e.location.search).board;return v(n),S(x.a.connect("https://feedback-dysiewicz.herokuapp.com",{query:"board=".concat(n)})),function(){I&&I.disconnect()}}}),[]),!I)return Object(a.jsx)("div",{});I.on("message",(function(e){s(e)})),I.on("initial-vote-visibility",(function(e){console.log("VOTE VIS",e),W(e)})),I.on("creator-disconnect",(function(e){J(e.msg),setTimeout((function(){I.close(),J(""),B("/")}),e.timeout)}));var K=function(e,t){var n=L.findIndex((function(t){return t.messageId===e.id}));if(-1===n)G([].concat(Object(f.a)(L),[{messageId:e.id,personalVotes:t}]));else{var a=L[n],c=Object(O.a)(Object(O.a)({},a),{},{personalVotes:a.personalVotes+t});if(Math.abs(c.personalVotes)>3)return alert("Can only vote 3 times per item");var o=L.filter((function(t){return t.messageId!==e.id}));G([].concat(Object(f.a)(o),[c]))}I.emit("upvote",{message:e,value:t})};I.on("toggle-votes",(function(){W(!U)}));return F?Object(a.jsx)(i.a,{to:{pathname:"/",state:{message:"Disconnected due to admin inactivity"}}}):Object(a.jsxs)("div",{className:"ChatBoard-main-div",children:[Object(a.jsx)("div",{className:"ChatBoard-info",children:Object(a.jsxs)("h1",{children:["Anonymous Feedback (RoomID: ",h,")"]})}),Object(a.jsxs)("div",{className:"ChatBoard-temp",children:[Object(a.jsx)("p",{children:Object(a.jsx)("strong",{children:"3 Votes Per Item"})}),N&&Object(a.jsx)(k,{socket:I,boardId:h,toggleHideVotes:function(){I.emit("toggle-votes")}})]}),Object(a.jsx)("button",{className:"ChatBoard-download",onClick:function(){return function(e){var t,n="data:text/csv;charset=utf-8,",a=Object.keys(e[0]);a.forEach((function(e){return n+="".concat(e,",")})),n+="\n",e.forEach((function(e){a.forEach((function(t){n+="".concat(e[t],",")})),n+="\n"}));var c=encodeURI(n),o=document.createElement("a");o.setAttribute("href",c),o.setAttribute("download","feedback.csv"),o.setAttribute("id","feedback-download-temp"),document.body.appendChild(o),o.click(),null===(t=document.getElementById("feedback-download-temp"))||void 0===t||t.remove()}(o)},children:"Download Feedback"}),T&&Object(a.jsx)("h3",{style:{color:"red"},children:T}),Object(a.jsxs)("div",{className:"ChatBoard-feedback-list",children:[Object(a.jsx)("h2",{children:"Feedback List"}),Object(a.jsx)("div",{children:o.map((function(e){var t=L.findIndex((function(t){return t.messageId===e.id})),n=-1===t?0:L[t].personalVotes;return Object(a.jsx)(C,{hideVotes:U,voteMessage:K,message:e,personalVote:n},e.id)}))})]}),Object(a.jsxs)("div",{className:"ChatBoard-write-message",children:[Object(a.jsx)("label",{htmlFor:"write-message",children:"Write a Message: "}),Object(a.jsx)("textarea",{id:"write-message",name:"write-message",value:l,placeholder:"Write a message",onChange:function(e){return b(e.target.value)}}),Object(a.jsx)("button",{id:"submit-message",name:"submit-message",onClick:function(){return function(){if(0===l.length)return alert("Message cannot be empty");var e={user:I.id,message:l,upvotes:0};I.emit("message",e),b("")}()},children:"Submit Message"})]})]})},I=(n(132),function(){return Object(a.jsx)("div",{className:"App-main-div",children:Object(a.jsx)(r.a,{children:Object(a.jsxs)(i.d,{children:[Object(a.jsx)(i.b,{exact:!0,path:"/",component:h}),Object(a.jsx)(i.b,{path:"/board",component:y})]})})})});s.a.render(Object(a.jsx)(I,{}),document.getElementById("root"))}},[[133,1,2]]]);
//# sourceMappingURL=main.c603a39d.chunk.js.map