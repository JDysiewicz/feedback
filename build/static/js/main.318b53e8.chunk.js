(this.webpackJsonpfeedback=this.webpackJsonpfeedback||[]).push([[0],{132:function(e,t,n){},133:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(1),c=n(66),s=n.n(c),o=n(38),i=n(2),d=n(13),u=n.n(d),l=n(19),b=n(4),j=n(21),m=n.n(j),h=function(e){return void 0!==e.isAxiosError},f=function(e){var t=Object(r.useState)(""),n=Object(b.a)(t,2),c=n[0],s=n[1],o=Object(r.useState)(),d=Object(b.a)(o,2),j=d[0],f=d[1];Object(r.useEffect)((function(){void 0!==e.location.state&&alert(e.location.state.message)}),[]);var O=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.get("/api/current-rooms");case 3:for(t=e.sent,n=t.data,a=(1e6*Math.random()).toString().split(".")[0];-1!==n.indexOf(a);)a=(1e6*Math.random()).toString().split(".")[0];r={search:"?board=".concat(a),roomCreator:!0},f(r),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==c){e.next=3;break}return alert("Room ID empty"),e.abrupt("return");case 3:return e.prev=3,e.next=6,m.a.get("/api/valid-room",{params:{boardId:c}});case 6:if(e.sent){e.next=9;break}return e.abrupt("return",console.log("No room by that name!"));case 9:f({search:"?board=".concat(c),roomCreator:!1}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),h(e.t0)&&400===(null===(t=e.t0.response)||void 0===t?void 0:t.status)?alert(e.t0.response.data.message+" (".concat(c,")")):alert("Something went wrong."),s("");case 16:return e.abrupt("return");case 17:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(){return e.apply(this,arguments)}}();return void 0!==j?Object(a.jsx)(i.a,{to:{pathname:"/board",search:j.search,state:{roomCreator:j.roomCreator,fromRedirect:!0}}}):Object(a.jsxs)("div",{className:"SplashScreen-main-div",children:[Object(a.jsx)("h1",{children:"Anonymous Feedback"}),Object(a.jsx)("button",{onClick:function(){return O()},children:"Create a room"}),Object(a.jsx)("h3",{children:"OR"}),Object(a.jsxs)("div",{className:"SplashScreen-join-room",children:[Object(a.jsx)("label",{htmlFor:"room-id",children:"RoomID:"}),Object(a.jsx)("input",{id:"room-id",name:"room-id",value:c,onChange:function(e){return s(e.target.value)},placeholder:"Enter Room ID"}),Object(a.jsx)("button",{onClick:function(){return p()},children:"Join an existing room using Room ID"})]})]})},O=n(22),p=n(68),v=n.n(p),g=n(41),x=n(69),k=n.n(x),C=function(e){return Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:function(){e.socket.emit("toggle-votes")},children:"Toggle Vote Visibility"})})},w=function(e){var t=e.message,n=e.personalVote,r=e.voteMessage,c=e.hideVotes;return Object(a.jsxs)("div",{className:"FeedbackMessage-main-div",children:[Object(a.jsx)("div",{className:"FeedbackMessage-personal-vote ".concat(function(e){switch(e){case 3:return"strong-agree";case 2:return"agree";case 1:return"partial-agree";case 0:return"neutral";case-1:return"partial-disagree";case-2:return"disagree";case-3:return"strong-disagree";default:return""}}(n)),children:Object(a.jsx)("strong",{children:n})}),Object(a.jsxs)("div",{className:"FeedbackMessage-info",children:[Object(a.jsxs)("div",{style:{alignSelf:"flex-end"},children:[Object(a.jsx)("button",{className:"FeedbackMessage-downvote-button",onClick:function(){return r(t,-1)}}),Object(a.jsx)("button",{className:"FeedbackMessage-upvote-button",onClick:function(){return r(t,1)}})]}),Object(a.jsxs)("p",{children:[t.message," "]}),Object(a.jsxs)("p",{children:[" ",Object(a.jsxs)("strong",{children:["Total Votes: ",c?Object(a.jsx)("i",{style:{color:"grey"},children:"hidden by room owner"}):t.upvotes," "]})]})]})]})},y=function(e){var t=e.messageList,n=e.votedMessages,r=e.hideVotes,c=e.voteMessage;return Object(a.jsx)(a.Fragment,{children:t.map((function(e){var t=n.findIndex((function(t){return t.messageId===e.id})),s=-1===t?0:n[t].personalVotes;return Object(a.jsx)(w,{hideVotes:r,voteMessage:c,message:e,personalVote:s},e.id)}))})},S=function(e){var t=e.boardId,n=e.didCreate,c=Object(r.useState)([]),s=Object(b.a)(c,2),o=s[0],d=s[1],u=Object(r.useState)(""),l=Object(b.a)(u,2),j=l[0],m=l[1],h=Object(r.useState)(),f=Object(b.a)(h,2),p=f[0],v=f[1],x=Object(r.useState)(""),w=Object(b.a)(x,2),S=w[0],I=w[1],N=Object(r.useState)(),M=Object(b.a)(N,2),E=M[0],V=M[1],F=Object(r.useState)(!0),B=Object(b.a)(F,2),D=B[0],R=B[1],A=Object(r.useState)([]),T=Object(b.a)(A,2),J=T[0],L=T[1];if(Object(r.useEffect)((function(){return p?(function(e,t){e.on("toggle-votes",(function(e){console.log("TOGGLEED VOTES"),t(e)}))}(p,R),function(e,t){e.on("message",(function(e){t(e)}))}(p,d),function(e){e.on("error",(function(e){alert("Error: ".concat(e))}))}(p),function(e,t,n){e.on("creator-disconnect",(function(a){t(a.msg),setTimeout((function(){e.close(),t(""),n("/")}),a.timeout)}))}(p,V,I)):v(k.a.connect("https://feedback-dysiewicz.herokuapp.com",{query:"board=".concat(t)})),function(){p&&p.disconnect()}}),[p]),!p)return Object(a.jsx)("div",{});if(S)return Object(a.jsx)(i.a,{to:{pathname:"/",state:{message:"Disconnected due to admin inactivity"}}});return Object(a.jsxs)("div",{className:"ChatBoard-main-div",children:[Object(a.jsxs)("div",{className:"ChatBoard-header-content",children:[Object(a.jsx)("div",{className:"ChatBoard-info",children:Object(a.jsx)("div",{children:Object(a.jsxs)("h1",{children:["Anonymous Feedback: RoomID - ",t]})})}),Object(a.jsx)("div",{className:"ChatBoard-temp",children:n&&Object(a.jsx)(C,{socket:p,boardId:t})}),Object(a.jsx)("button",{className:"ChatBoard-download",onClick:function(){return function(e){var t,n="data:text/csv;charset=utf-8,",a=Object.keys(e[0]);a.forEach((function(e){return n+="".concat(e,",")})),n+="\n",e.forEach((function(e){a.forEach((function(t){n+="".concat(e[t],",")})),n+="\n"}));var r=encodeURI(n),c=document.createElement("a");c.setAttribute("href",r),c.setAttribute("download","feedback.csv"),c.setAttribute("id","feedback-download-temp"),document.body.appendChild(c),c.click(),null===(t=document.getElementById("feedback-download-temp"))||void 0===t||t.remove()}(o)},children:"Download Feedback"}),E&&Object(a.jsx)("h3",{style:{color:"red"},children:E})]}),Object(a.jsx)("div",{className:"ChatBoard-feedback-list",children:Object(a.jsx)("div",{className:"ChatBoard-feedback-grid",children:Object(a.jsx)(y,{messageList:o,votedMessages:J,hideVotes:D,voteMessage:function(e,t){var n=J.findIndex((function(t){return t.messageId===e.id}));if(-1===n)L([].concat(Object(g.a)(J),[{messageId:e.id,personalVotes:t}]));else{var a=J[n],r=Object(O.a)(Object(O.a)({},a),{},{personalVotes:a.personalVotes+t});if(Math.abs(r.personalVotes)>3)return alert("Can only vote 3 times per item");var c=J.filter((function(t){return t.messageId!==e.id}));L([].concat(Object(g.a)(c),[r]))}!function(e,t,n){e.emit("upvote",{message:t,value:n})}(p,e,t)}})})}),Object(a.jsxs)("div",{className:"ChatBoard-write-message",children:[Object(a.jsxs)("label",{htmlFor:"write-message",children:["Write a Message: ",Object(a.jsxs)("small",{children:[j.length,"/150"]})]}),Object(a.jsx)("textarea",{id:"write-message",name:"write-message",value:j,onChange:function(e){return m(e.target.value)}}),Object(a.jsx)("button",{id:"submit-message",name:"submit-message",onClick:function(){return function(){var e=function(e){return 0===e.length?"Message cannot be empty":e.includes("\n")?"New line characters are not permitted":e.length>150?"Maximum character limit of 300":null}(j);e?alert(e):(function(e,t){var n={user:e.id,message:t,upvotes:0};e.emit("message",n)}(p,j),m(""))}()},children:"Submit Message"})]})]})},I=function(){return Object(a.jsxs)("div",{className:"Error404Page-main-div",children:[Object(a.jsx)("h1",{children:"Error: 404"}),Object(a.jsx)("p",{children:"Sorry, we couldnt find the page you were looking for. Please double check that the room ID is correct."}),Object(a.jsx)("a",{href:"/",children:"Click here to go to the main screen"})]})},N=function(e){var t=Object(r.useState)(null),n=Object(b.a)(t,2),c=n[0],s=n[1],o=Object(r.useState)({boardId:"",didCreate:!1}),i=Object(b.a)(o,2),d=i[0],j=i[1];return Object(r.useEffect)((function(){(function(){var t=Object(l.a)(u.a.mark((function t(){var n,a,r,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.location.search,/^\?board=[0-9]*$/.test(n)){t.next=5;break}return s(!1),t.abrupt("return");case 5:if(a=v.a.parse(e.location.search).board,!e.location.state){t.next=10;break}return j({boardId:a,didCreate:e.location.state.roomCreator}),s(!0),t.abrupt("return");case 10:return t.prev=10,t.next=13,m.a.get("/api/valid-room",{params:{boardId:a}});case 13:200===t.sent.status&&(r=!0),t.next=22;break;case 17:return t.prev=17,t.t0=t.catch(10),h(t.t0)&&400===(null===(c=t.t0.response)||void 0===c?void 0:c.status)?alert(t.t0.response.data.message+" (".concat(a,")")):alert("Something went wrong."),s(!1),t.abrupt("return");case 22:if(!0===r){t.next=25;break}return s(!1),t.abrupt("return");case 25:j({boardId:a,didCreate:!1}),s(!0);case 27:case"end":return t.stop()}}),t,null,[[10,17]])})));return function(){return t.apply(this,arguments)}})()()}),[]),null===c?Object(a.jsx)("div",{}):!1===c?Object(a.jsx)(I,{}):Object(a.jsx)(S,Object(O.a)({},d))},M=(n(132),function(){return Object(a.jsx)("div",{className:"App-main-div",children:Object(a.jsx)(o.a,{children:Object(a.jsxs)(i.d,{children:[Object(a.jsx)(i.b,{exact:!0,path:"/",component:f}),Object(a.jsx)(i.b,{path:"/board",component:N}),Object(a.jsx)(I,{})]})})})});s.a.render(Object(a.jsx)(M,{}),document.getElementById("root"))}},[[133,1,2]]]);
//# sourceMappingURL=main.318b53e8.chunk.js.map