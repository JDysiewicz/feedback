(this.webpackJsonpfeedback=this.webpackJsonpfeedback||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var o=n(1),c=n(0),a=n(54),r=n.n(a),s=n(33),i=n(2),u=n(6),d=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)(),d=Object(u.a)(s,2),b=d[0],j=d[1];Object(c.useEffect)((function(){void 0!==e.location.state&&alert(e.location.state.message)}),[]);return void 0!==b?Object(o.jsx)(i.a,{to:{pathname:"/board",search:b.search,state:{roomCreator:b.roomCreator}}}):Object(o.jsxs)("div",{children:[Object(o.jsx)("button",{onClick:function(){return function(){var e=(1e6*Math.random()).toString().split(".")[0],t={search:"?board=".concat(e),roomCreator:!0};j(t)}()},children:"Create a room"}),Object(o.jsx)("input",{value:a,onChange:function(e){return r(e.target.value)},placeholder:"Room ID"}),Object(o.jsx)("button",{onClick:function(){""!==a?j({search:"?board=".concat(a),roomCreator:!1}):console.log("Room ID empty")},children:"Join an existing room using Room ID"})]})},b=n(37),j=n(36),l=n(56),O=n.n(l),f=n(57),h=n.n(f),m=function(e){return Object(o.jsx)("div",{children:Object(o.jsx)("button",{onClick:function(){return e.toggleHideVotes()},children:"Toggle Vote Visibility"})})},v=function(e){if(""===e.location.search)return Object(o.jsx)("div",{children:"Please create or join a room"});var t=Object(c.useState)([]),n=Object(u.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)(""),d=Object(u.a)(s,2),l=d[0],f=d[1],v=Object(c.useState)(""),p=Object(u.a)(v,2),x=p[0],g=p[1],k=Object(c.useState)(),C=Object(u.a)(k,2),I=C[0],y=C[1],S=Object(c.useState)(!1),V=Object(u.a)(S,2),E=V[0],w=V[1],D=Object(c.useState)(""),R=Object(u.a)(D,2),A=R[0],M=R[1],T=Object(c.useState)(),J=Object(u.a)(T,2),P=J[0],B=J[1],F=Object(c.useState)(!0),H=Object(u.a)(F,2),U=H[0],q=H[1],z=Object(c.useState)([]),W=Object(u.a)(z,2),G=W[0],K=W[1];if(Object(c.useEffect)((function(){if(""!==e.location.search){if(void 0!==e.location.state){var t=e.location.state.roomCreator;w(t)}var n=O.a.parse(e.location.search).board;return g(n),y(h.a.connect("https://feedback-dysiewicz.herokuapp.com",{query:"board=".concat(n)})),function(){I&&I.disconnect()}}}),[]),!I)return Object(o.jsx)("div",{});I.on("message",(function(e){r(e)})),I.on("initial-vote-visibility",(function(e){console.log("VOTE VIS",e),q(e)})),I.on("creator-disconnect",(function(e){B(e.msg),setTimeout((function(){I.close(),B(""),M("/")}),e.timeout)}));var L=function(e,t){var n=G.findIndex((function(t){return t.messageId===e.id}));if(-1===n)K([].concat(Object(j.a)(G),[{messageId:e.id,personalVotes:t}]));else{var o=G[n],c=Object(b.a)(Object(b.a)({},o),{},{personalVotes:o.personalVotes+t});if(Math.abs(c.personalVotes)>3)return alert("Can only vote 3 times per item");var a=G.filter((function(t){return t.messageId!==e.id}));K([].concat(Object(j.a)(a),[c]))}I.emit("upvote",{message:e,value:t})};I.on("toggle-votes",(function(){q(!U)}));return A?Object(o.jsx)(i.a,{to:{pathname:"/",state:{message:"Disconnected due to admin inactivity"}}}):Object(o.jsxs)("div",{children:[Object(o.jsx)("h1",{children:"Anonymous Feedback"}),Object(o.jsxs)("h2",{children:["RoomID: ",x]}),P&&Object(o.jsx)("h2",{style:{color:"red"},children:P}),Object(o.jsx)("ul",{children:a.map((function(e){var t=G.findIndex((function(t){return t.messageId===e.id})),n=-1===t?0:G[t].personalVotes;return Object(o.jsx)("li",{children:Object(o.jsxs)("div",{style:{display:"flex"},children:[Object(o.jsxs)("p",{children:["Message: ",e.message," "]}),Object(o.jsxs)("p",{children:["Personal Votes: ",n]}),!U&&Object(o.jsxs)("p",{children:["Total Votes: ",e.upvotes]}),Object(o.jsx)("button",{onClick:function(){return L(e,1)},children:"Upvote"}),Object(o.jsx)("button",{onClick:function(){return L(e,-1)},children:"Downvote"})]})},e.id)}))}),Object(o.jsx)("button",{onClick:function(){return function(e){var t,n="data:text/csv;charset=utf-8,",o=Object.keys(e[0]);o.forEach((function(e){return n+="".concat(e,",")})),n+="\n",e.forEach((function(e){o.forEach((function(t){n+="".concat(e[t],",")})),n+="\n"}));var c=encodeURI(n),a=document.createElement("a");a.setAttribute("href",c),a.setAttribute("download","feedback.csv"),a.setAttribute("id","feedback-download-temp"),document.body.appendChild(a),a.click(),null===(t=document.getElementById("feedback-download-temp"))||void 0===t||t.remove()}(a)},children:"Download Feedback"}),Object(o.jsx)("input",{value:l,placeholder:"Write a message",onChange:function(e){return f(e.target.value)}}),Object(o.jsx)("button",{onClick:function(){return function(){var e={user:I.id,message:l,upvotes:0};I.emit("message",e),f("")}()},children:"Submit Message"}),Object(o.jsx)("p",{children:Object(o.jsx)("strong",{children:"3 Votes Per Item"})}),E&&Object(o.jsx)(m,{socket:I,boardId:x,toggleHideVotes:function(){I.emit("toggle-votes")}})]})},p=function(){return Object(o.jsx)(s.a,{children:Object(o.jsxs)(i.d,{children:[Object(o.jsx)(i.b,{exact:!0,path:"/",component:d}),Object(o.jsx)(i.b,{path:"/board",component:v})]})})};r.a.render(Object(o.jsx)(p,{}),document.getElementById("root"))}},[[103,1,2]]]);
//# sourceMappingURL=main.858d9855.chunk.js.map